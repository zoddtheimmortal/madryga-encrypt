# Madryga Encrypt

C++ implementation of Madryga Encryption which will encrypt and decrypt the contents of a file directory.

## About Madryga Encryption

The [Madryga](https://cocomelonc.github.io/malware/2023/03/09/malware-av-evasion-13.html) encryption algorithm is a symmetric key encryption algorithm that uses a Feistel network and a key schedule to encrypt plaintext. Hereâ€™s a step-by-step flow of the Madryga encryption algorithm with delta 0x9e377989:

    Input: plaintext P, key K, number of rounds N
    Split P into two equal halves L and R
    Generate N subkeys K0 to KN-1 using the key schedule. Each subkey Ki is generated by XORing K with the constant delta raised to the power of i mod 4.
        K0 = K
        Ki = Ki-1 XOR delta^(i mod 4)
    For each round i from 1 to N:
        Compute the round function F:
            F(R, Ki) = ((R <<< 7) XOR Ki) + (R >>> 5)
        Update L and R:
            L' = R
            R' = L XOR F(R, Ki)
    Output: ciphertext C is the concatenation of L' and R'.

## Usage

-   Create a .env file by following the .env.example
-   Compile main.cpp - `g++ main.cpp -o main`
-   Execute main - `./main <mode(encrypt/decrypt)> <directory/file address>`
